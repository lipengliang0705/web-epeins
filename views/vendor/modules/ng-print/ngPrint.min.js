var ngPrint=angular.module("ngPrint",[]);
ngPrint.factory("pdfPrinter",["$q","$timeout",function(t){"use strict";var e=function(){var e=this,r=function(t,e){if(e=parseInt(e,10)||0,!e)return t;var r=document.createElement("canvas"),n=r.getContext("2d");return r.height=t.height-e,r.width=t.width,Pixastic.process(t,"crop",{rect:{left:0,top:e,width:t.width,height:t.height-e}},function(t){n.drawImage(t,0,0,t.width,t.height,0,0,t.width,t.height)}),r},n=function(t,e,n,i){for(var a=new jsPDF(e,n,i),h=a.internal,o=h.pageSize,d=h.scaleFactor,c=o.width,g=o.height,u=0,f=t.height,s=t.width/(c*d),w=0;f>u&&15>w;){var m=r(t,u),v=Math.random().toString(35);a.addImage(m,0,0,c,0,"png",v,"SLOW"),u+=g*d*s,f>u&&a.addPage(),w+=1}return a};e.generatePdfFromElement=function(e,r,i,a){var h=t.defer();return html2canvas(e,{onrendered:function(t){var e=n(t,r,i,a);h.resolve(e)}}),h.promise}},r=new e;return r}]);
ngPrint.directive("ngPrintButton",["$window","pdfPrinter",function(t,n){"use strict";return{restrict:"AC",require:"^ngPrintable",scope:{printWholePage:"&?",saveAs:"@?"},link:function(e,i,r,a){var o=function(t){return{orientation:t[0].attributes.orientation?t[0].attributes.orientation.value:"p",unit:t[0].attributes.unit?t[0].attributes.unit.value:"pt",format:t[0].attributes.format?t[0].attributes.format.value:"a4"}};e.print=function(){var i;if(e.printWholePage()?i=t.document.body:a&&(i=a.getElement()),!i)throw new SyntaxError("No template element provided. Try using ngPrintable directive.");var r=o(i),u=n.generatePdfFromElement(i,r.orientation,r.unit,r.format);u.then(function(t){e.saveAs?t.save(e.saveAs):t.output("dataurlnewwindow"),t=null})},i.on("click",function(){e.print()})}}}]);
ngPrint.directive("ngPrintable",[function(){"use strict";return{restrict:"A",scope:{orientation:"@?",unit:"@?",format:"@?"},link:function(t,n){t.element=n},controller:function(t){this.getElement=function(){return t.element}}}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5nUHJpbnQtbW9kdWxlLmpzIiwicGRmUHJpbnRlci1zZXJ2aWNlLmpzIiwiY29tcG9uZW50c1xcZGlyZWN0aXZlc1xcbmdQcmludEJ1dHRvblxcbmdQcmludEJ1dHRvbi1kaXJlY3RpdmUuanMiLCJjb21wb25lbnRzXFxkaXJlY3RpdmVzXFxuZ1ByaW50YWJsZVxcbmdQcmludGFibGUtZGlyZWN0aXZlLmpzIl0sIm5hbWVzIjpbIm5nUHJpbnQiLCJhbmd1bGFyIiwibW9kdWxlIiwiZmFjdG9yeSIsIiRxIiwiUGRmUHJpbnRlciIsInNlbGYiLCJ0aGlzIiwiY2FudmFzU2hpZnRJbWFnZSIsIm9sZENhbnZhcyIsInNoaWZ0QW10IiwicGFyc2VJbnQiLCJuZXdDYW52YXMiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJjdHgiLCJnZXRDb250ZXh0IiwiaGVpZ2h0Iiwid2lkdGgiLCJQaXhhc3RpYyIsInByb2Nlc3MiLCJyZWN0IiwibGVmdCIsInRvcCIsImRyYXdJbWFnZSIsImdlbmVyYXRlUGRmRnJvbUNhbnZhcyIsImNhbnZhcyIsIm9yaWVudGF0aW9uIiwidW5pdCIsImZvcm1hdCIsInBkZiIsImpzUERGIiwicGRmSW50ZXJuYWxzIiwiaW50ZXJuYWwiLCJwZGZQYWdlU2l6ZSIsInBhZ2VTaXplIiwicGRmU2NhbGVGYWN0b3IiLCJzY2FsZUZhY3RvciIsInBkZlBhZ2VXaWR0aCIsInBkZlBhZ2VIZWlnaHQiLCJ0b3RhbFBkZkhlaWdodCIsImh0bWxQYWdlSGVpZ2h0IiwiaHRtbFNjYWxlRmFjdG9yIiwic2FmZXR5TmV0IiwiYWxpYXMiLCJNYXRoIiwicmFuZG9tIiwidG9TdHJpbmciLCJhZGRJbWFnZSIsImFkZFBhZ2UiLCJnZW5lcmF0ZVBkZkZyb21FbGVtZW50IiwiZWxlbWVudCIsImRlZmVycmVkIiwiZGVmZXIiLCJodG1sMmNhbnZhcyIsIm9ucmVuZGVyZWQiLCJyZXNvbHZlIiwicHJvbWlzZSIsImluc3QiLCJkaXJlY3RpdmUiLCIkd2luZG93IiwicGRmUHJpbnRlciIsInJlc3RyaWN0IiwicmVxdWlyZSIsInNjb3BlIiwicHJpbnRXaG9sZVBhZ2UiLCJzYXZlQXMiLCJsaW5rIiwiJHNjb3BlIiwiYXR0ciIsIm5nUHJpbnRhYmxlQ29udHJvbGxlciIsImdldENvbmZpZ0F0dHJpYnV0ZXMiLCJhdHRyaWJ1dGVzIiwidmFsdWUiLCJwcmludCIsImJvZHkiLCJnZXRFbGVtZW50IiwiU3ludGF4RXJyb3IiLCJjb25maWciLCJ0aGVuIiwic2F2ZSIsIm91dHB1dCIsIm9uIiwiY29udHJvbGxlciJdLCJtYXBwaW5ncyI6IkFBRUEsR0FBSUEsU0FBVUMsUUFBUUMsT0FBTztBQ0E3QkYsUUFBUUcsUUFBUSxjQUFlLEtBQU0sV0FBWSxTQUFVQyxHQUN2RCxZQUVILElBQUlDLEdBQWEsV0FDaEIsR0FBSUMsR0FBT0MsS0FDREMsRUFBbUIsU0FBVUMsRUFBV0MsR0FFcEMsR0FEQUEsRUFBV0MsU0FBU0QsRUFBVSxLQUFPLEdBQ2hDQSxFQUFZLE1BQU9ELEVBRXhCLElBQUlHLEdBQVlDLFNBQVNDLGNBQWMsVUFDbkNDLEVBQU1ILEVBQVVJLFdBQVcsS0FTL0IsT0FQQUosR0FBVUssT0FBU1IsRUFBVVEsT0FBU1AsRUFDdENFLEVBQVVNLE1BQVFULEVBQVVTLE1BRTVCQyxTQUFTQyxRQUFRWCxFQUFXLFFBQVNZLE1BQU9DLEtBQU0sRUFBR0MsSUFBS2IsRUFBVVEsTUFBT1QsRUFBVVMsTUFBT0QsT0FBU1IsRUFBVVEsT0FBU1AsSUFBYSxTQUFVRSxHQUMzSUcsRUFBSVMsVUFBVVosRUFBVyxFQUFHLEVBQUdBLEVBQVVNLE1BQU9OLEVBQVVLLE9BQVEsRUFBRyxFQUFHTCxFQUFVTSxNQUFPTixFQUFVSyxVQUdoR0wsR0FZWGEsRUFBd0IsU0FBVUMsRUFBUUMsRUFBYUMsRUFBTUMsR0FZekQsSUFYQSxHQUFJQyxHQUFNLEdBQUlDLE9BQU1KLEVBQWFDLEVBQU1DLEdBQ25DRyxFQUFlRixFQUFJRyxTQUNuQkMsRUFBY0YsRUFBYUcsU0FDM0JDLEVBQWlCSixFQUFhSyxZQUM5QkMsRUFBZUosRUFBWWhCLE1BQzNCcUIsRUFBZ0JMLEVBQVlqQixPQUM1QnVCLEVBQWlCLEVBQ2pCQyxFQUFpQmYsRUFBT1QsT0FDeEJ5QixFQUFrQmhCLEVBQU9SLE9BQVNvQixFQUFlRixHQUNqRE8sRUFBWSxFQUVRRixFQUFqQkQsR0FBK0MsR0FBWkcsR0FBZ0IsQ0FDdEQsR0FBSS9CLEdBQVlKLEVBQWlCa0IsRUFBUWMsR0FDckNJLEVBQVFDLEtBQUtDLFNBQVNDLFNBQVMsR0FFbkNqQixHQUFJa0IsU0FBU3BDLEVBQVcsRUFBRyxFQUFHMEIsRUFBYyxFQUFHLE1BQU9NLEVBQU8sUUFFN0RKLEdBQW1CRCxFQUFnQkgsRUFBaUJNLEVBRS9CRCxFQUFqQkQsR0FDQVYsRUFBSW1CLFVBRVJOLEdBQWEsRUFHakIsTUFBT2IsR0FHbEJ4QixHQUFLNEMsdUJBQXlCLFNBQVVDLEVBQVN4QixFQUFhQyxFQUFNQyxHQUM3RCxHQUFJdUIsR0FBV2hELEVBQUdpRCxPQVNsQixPQVBBQyxhQUFZSCxHQUNSSSxXQUFZLFNBQVU3QixHQUNsQixHQUFJSSxHQUFNTCxFQUFzQkMsRUFBUUMsRUFBYUMsRUFBTUMsRUFDM0R1QixHQUFTSSxRQUFRMUIsTUFJbEJzQixFQUFTSyxVQUlwQkMsRUFBTyxHQUFJckQsRUFFbEIsT0FBT3FEO0FDM0VSMUQsUUFBUTJELFVBQVUsaUJBQWtCLFVBQVcsYUFBYyxTQUFVQyxFQUFTQyxHQUM1RSxZQUVILFFBQ0NDLFNBQVUsS0FDVkMsUUFBUyxlQUNUQyxPQUNDQyxlQUFnQixLQUNQQyxPQUFRLE1BRWxCQyxLQUFNLFNBQVVDLEVBQVFqQixFQUFTa0IsRUFBTUMsR0FDdEMsR0FBSUMsR0FBc0IsU0FBVXBCLEdBQ25DLE9BQ0N4QixZQUFhd0IsRUFBUSxHQUFHcUIsV0FBd0IsWUFBSXJCLEVBQVEsR0FBR3FCLFdBQXdCLFlBQUVDLE1BQVEsSUFDakc3QyxLQUFNdUIsRUFBUSxHQUFHcUIsV0FBaUIsS0FBSXJCLEVBQVEsR0FBR3FCLFdBQWlCLEtBQUVDLE1BQVEsS0FDNUU1QyxPQUFRc0IsRUFBUSxHQUFHcUIsV0FBbUIsT0FBSXJCLEVBQVEsR0FBR3FCLFdBQW1CLE9BQUVDLE1BQVEsTUFJcEZMLEdBQU9NLE1BQVEsV0FDZCxHQUFJdkIsRUFRSixJQU5JaUIsRUFBT0gsaUJBQ1ZkLEVBQVVTLEVBQVEvQyxTQUFTOEQsS0FDakJMLElBQ1ZuQixFQUFVbUIsRUFBc0JNLGVBRzdCekIsRUFjSCxLQUFNLElBQUkwQixhQUFZLGlFQWJ0QixJQUFJQyxHQUFTUCxFQUFvQnBCLEdBQzdCTSxFQUFVSSxFQUFXWCx1QkFBdUJDLEVBQVMyQixFQUFPbkQsWUFBYW1ELEVBQU9sRCxLQUFNa0QsRUFBT2pELE9BRWxGNEIsR0FBUXNCLEtBQUssU0FBVWpELEdBQ2hCc0MsRUFBT0YsT0FDTnBDLEVBQUlrRCxLQUFLWixFQUFPRixRQUVoQnBDLEVBQUltRCxPQUFPLG9CQUdmbkQsRUFBTSxRQU8zQnFCLEVBQVErQixHQUFHLFFBQVMsV0FDUGQsRUFBT007QUNoRHZCMUUsUUFBUTJELFVBQVUsZUFBZ0IsV0FDOUIsWUFFSCxRQUNDRyxTQUFVLElBQ0pFLE9BQ0lyQyxZQUFhLEtBQ2JDLEtBQU0sS0FDTkMsT0FBUSxNQUVsQnNDLEtBQU0sU0FBVUMsRUFBUWpCLEdBQ3ZCaUIsRUFBT2pCLFFBQVVBLEdBRVpnQyxXQUFZLFNBQVVmLEdBQ2xCN0QsS0FBS3FFLFdBQWEsV0FDZCxNQUFPUixHQUFPakIiLCJmaWxlIjoibmdQcmludC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKmdsb2JhbCBhbmd1bGFyICovXHJcblxyXG52YXIgbmdQcmludCA9IGFuZ3VsYXIubW9kdWxlKCduZ1ByaW50JywgW10pOyIsIi8qZ2xvYmFsIG5nUHJpbnQsIFBpeGFzdGljLCBqc1BERiwgaHRtbDJjYW52YXMgKi9cclxuXHJcbm5nUHJpbnQuZmFjdG9yeSgncGRmUHJpbnRlcicsIFsnJHEnLCAnJHRpbWVvdXQnLCBmdW5jdGlvbiAoJHEsICR0aW1lb3V0KSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcbiAgICBcclxuXHR2YXIgUGRmUHJpbnRlciA9IGZ1bmN0aW9uICgpIHtcclxuXHRcdHZhciBzZWxmID0gdGhpcyxcclxuICAgICAgICAgICAgY2FudmFzU2hpZnRJbWFnZSA9IGZ1bmN0aW9uIChvbGRDYW52YXMsIHNoaWZ0QW10KSB7XHJcbiAgICAgICAgICAgICAgICBzaGlmdEFtdCA9IHBhcnNlSW50KHNoaWZ0QW10LCAxMCkgfHwgMDtcclxuICAgICAgICAgICAgICAgIGlmICghc2hpZnRBbXQpIHsgcmV0dXJuIG9sZENhbnZhczsgfVxyXG5cclxuICAgICAgICAgICAgICAgIHZhciBuZXdDYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKSxcclxuICAgICAgICAgICAgICAgICAgICBjdHggPSBuZXdDYW52YXMuZ2V0Q29udGV4dCgnMmQnKTtcclxuXHJcbiAgICAgICAgICAgICAgICBuZXdDYW52YXMuaGVpZ2h0ID0gb2xkQ2FudmFzLmhlaWdodCAtIHNoaWZ0QW10O1xyXG4gICAgICAgICAgICAgICAgbmV3Q2FudmFzLndpZHRoID0gb2xkQ2FudmFzLndpZHRoO1xyXG5cclxuICAgICAgICAgICAgICAgIFBpeGFzdGljLnByb2Nlc3Mob2xkQ2FudmFzLCBcImNyb3BcIiwge3JlY3Q6IHtsZWZ0OiAwLCB0b3A6IHNoaWZ0QW10LCB3aWR0aDogb2xkQ2FudmFzLndpZHRoLCBoZWlnaHQ6IChvbGRDYW52YXMuaGVpZ2h0IC0gc2hpZnRBbXQpfX0sIGZ1bmN0aW9uIChuZXdDYW52YXMpIHtcclxuICAgICAgICAgICAgICAgICAgICBjdHguZHJhd0ltYWdlKG5ld0NhbnZhcywgMCwgMCwgbmV3Q2FudmFzLndpZHRoLCBuZXdDYW52YXMuaGVpZ2h0LCAwLCAwLCBuZXdDYW52YXMud2lkdGgsIG5ld0NhbnZhcy5oZWlnaHQpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ld0NhbnZhcztcclxuICAgICAgICAgICAgfSxcclxuXHQgICAgXHJcbiAgICAgICAgICAgIC8qKlxyXG4gICAgICAgICAgICAgKiBDcmVhdGVzIG5ldyBqc1BERiBkb2N1bWVudCBvYmplY3QgaW5zdGFuY2UuXHJcbiAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAqIEBwYXJhbSBvcmllbnRhdGlvbiBPbmUgb2YgXCJwb3J0cmFpdFwiIG9yIFwibGFuZHNjYXBlXCIgKG9yIHNob3J0Y3V0cyBcInBcIiAoRGVmYXVsdCksIFwibFwiKVxyXG4gICAgICAgICAgICAgKiBAcGFyYW0gdW5pdCAgICAgICAgTWVhc3VyZW1lbnQgdW5pdCB0byBiZSB1c2VkIHdoZW4gY29vcmRpbmF0ZXMgYXJlIHNwZWNpZmllZC5cclxuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgIE9uZSBvZiBcInB0XCIgKHBvaW50cyksIFwibW1cIiAoRGVmYXVsdCksIFwiY21cIiwgXCJpblwiXHJcbiAgICAgICAgICAgICAqIEBwYXJhbSBmb3JtYXQgICAgICBPbmUgb2YgJ3BhZ2VGb3JtYXRzJyBhcyB2aXNpYmxlIGluIGpzUERGIGRvY3MsIGRlZmF1bHQ6IGE0XHJcbiAgICAgICAgICAgICAqIEByZXR1cm5zIHtqc1BERn1cclxuICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgIGdlbmVyYXRlUGRmRnJvbUNhbnZhcyA9IGZ1bmN0aW9uIChjYW52YXMsIG9yaWVudGF0aW9uLCB1bml0LCBmb3JtYXQpIHtcclxuICAgICAgICAgICAgICAgIHZhciBwZGYgPSBuZXcganNQREYob3JpZW50YXRpb24sIHVuaXQsIGZvcm1hdCksXHJcbiAgICAgICAgICAgICAgICAgICAgcGRmSW50ZXJuYWxzID0gcGRmLmludGVybmFsLFxyXG4gICAgICAgICAgICAgICAgICAgIHBkZlBhZ2VTaXplID0gcGRmSW50ZXJuYWxzLnBhZ2VTaXplLFxyXG4gICAgICAgICAgICAgICAgICAgIHBkZlNjYWxlRmFjdG9yID0gcGRmSW50ZXJuYWxzLnNjYWxlRmFjdG9yLFxyXG4gICAgICAgICAgICAgICAgICAgIHBkZlBhZ2VXaWR0aCA9IHBkZlBhZ2VTaXplLndpZHRoLFxyXG4gICAgICAgICAgICAgICAgICAgIHBkZlBhZ2VIZWlnaHQgPSBwZGZQYWdlU2l6ZS5oZWlnaHQsXHJcbiAgICAgICAgICAgICAgICAgICAgdG90YWxQZGZIZWlnaHQgPSAwLFxyXG4gICAgICAgICAgICAgICAgICAgIGh0bWxQYWdlSGVpZ2h0ID0gY2FudmFzLmhlaWdodCxcclxuICAgICAgICAgICAgICAgICAgICBodG1sU2NhbGVGYWN0b3IgPSBjYW52YXMud2lkdGggLyAocGRmUGFnZVdpZHRoICogcGRmU2NhbGVGYWN0b3IpLFxyXG4gICAgICAgICAgICAgICAgICAgIHNhZmV0eU5ldCA9IDA7XHJcblxyXG4gICAgICAgICAgICAgICAgd2hpbGUgKHRvdGFsUGRmSGVpZ2h0IDwgaHRtbFBhZ2VIZWlnaHQgJiYgc2FmZXR5TmV0IDwgMTUpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgbmV3Q2FudmFzID0gY2FudmFzU2hpZnRJbWFnZShjYW52YXMsIHRvdGFsUGRmSGVpZ2h0KSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWxpYXMgPSBNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM1KTtcclxuICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICBwZGYuYWRkSW1hZ2UobmV3Q2FudmFzLCAwLCAwLCBwZGZQYWdlV2lkdGgsIDAsICdwbmcnLCBhbGlhcywgJ1NMT1cnKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdG90YWxQZGZIZWlnaHQgKz0gKHBkZlBhZ2VIZWlnaHQgKiBwZGZTY2FsZUZhY3RvciAqIGh0bWxTY2FsZUZhY3Rvcik7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0b3RhbFBkZkhlaWdodCA8IGh0bWxQYWdlSGVpZ2h0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBkZi5hZGRQYWdlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHNhZmV0eU5ldCArPSAxO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybiBwZGY7XHJcbiAgICAgICAgICAgIH07XHJcblxyXG5cdCAgICBzZWxmLmdlbmVyYXRlUGRmRnJvbUVsZW1lbnQgPSBmdW5jdGlvbiAoZWxlbWVudCwgb3JpZW50YXRpb24sIHVuaXQsIGZvcm1hdCkge1xyXG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgaHRtbDJjYW52YXMoZWxlbWVudCwge1xyXG4gICAgICAgICAgICAgICAgb25yZW5kZXJlZDogZnVuY3Rpb24gKGNhbnZhcykge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBwZGYgPSBnZW5lcmF0ZVBkZkZyb21DYW52YXMoY2FudmFzLCBvcmllbnRhdGlvbiwgdW5pdCwgZm9ybWF0KTtcclxuICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHBkZik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XHJcblx0ICAgIH07XHJcblx0fSxcclxuXHJcbiAgICAgICAgaW5zdCA9IG5ldyBQZGZQcmludGVyKCk7XHJcbiAgICBcclxuXHRyZXR1cm4gaW5zdDtcclxufV0pOyIsIi8qZ2xvYmFsIG5nUHJpbnQqL1xyXG5cclxuXHJcbm5nUHJpbnQuZGlyZWN0aXZlKCduZ1ByaW50QnV0dG9uJywgWyckd2luZG93JywgJ3BkZlByaW50ZXInLCBmdW5jdGlvbiAoJHdpbmRvdywgcGRmUHJpbnRlcikge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG4gICAgXHJcblx0cmV0dXJuIHtcclxuXHRcdHJlc3RyaWN0OiAnQUMnLFxyXG5cdFx0cmVxdWlyZTogJ15uZ1ByaW50YWJsZScsXHJcblx0XHRzY29wZToge1xyXG5cdFx0XHRwcmludFdob2xlUGFnZTogJyY/JyxcclxuICAgICAgICAgICAgc2F2ZUFzOiAnQD8nXHJcblx0XHR9LFxyXG5cdFx0bGluazogZnVuY3Rpb24gKCRzY29wZSwgZWxlbWVudCwgYXR0ciwgbmdQcmludGFibGVDb250cm9sbGVyKSB7XHJcblx0XHRcdHZhciBnZXRDb25maWdBdHRyaWJ1dGVzID0gZnVuY3Rpb24gKGVsZW1lbnQpIHtcclxuXHRcdFx0XHRyZXR1cm4ge1xyXG5cdFx0XHRcdFx0b3JpZW50YXRpb246IGVsZW1lbnRbMF0uYXR0cmlidXRlc1snb3JpZW50YXRpb24nXSA/IGVsZW1lbnRbMF0uYXR0cmlidXRlc1snb3JpZW50YXRpb24nXS52YWx1ZSA6ICdwJyxcclxuXHRcdFx0XHRcdHVuaXQ6IGVsZW1lbnRbMF0uYXR0cmlidXRlc1sndW5pdCddID8gZWxlbWVudFswXS5hdHRyaWJ1dGVzWyd1bml0J10udmFsdWUgOiAncHQnLFxyXG5cdFx0XHRcdFx0Zm9ybWF0OiBlbGVtZW50WzBdLmF0dHJpYnV0ZXNbJ2Zvcm1hdCddID8gZWxlbWVudFswXS5hdHRyaWJ1dGVzWydmb3JtYXQnXS52YWx1ZSA6ICdhNCdcclxuXHRcdFx0XHR9O1xyXG5cdFx0XHR9O1xyXG5cclxuXHRcdFx0JHNjb3BlLnByaW50ID0gZnVuY3Rpb24gKCkge1xyXG5cdFx0XHRcdHZhciBlbGVtZW50O1xyXG5cclxuXHRcdFx0XHRpZiAoJHNjb3BlLnByaW50V2hvbGVQYWdlKCkpIHtcclxuXHRcdFx0XHRcdGVsZW1lbnQgPSAkd2luZG93LmRvY3VtZW50LmJvZHk7XHJcblx0XHRcdFx0fSBlbHNlIGlmIChuZ1ByaW50YWJsZUNvbnRyb2xsZXIpIHtcclxuXHRcdFx0XHRcdGVsZW1lbnQgPSBuZ1ByaW50YWJsZUNvbnRyb2xsZXIuZ2V0RWxlbWVudCgpO1xyXG5cdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0aWYgKGVsZW1lbnQpIHtcclxuXHRcdFx0XHRcdHZhciBjb25maWcgPSBnZXRDb25maWdBdHRyaWJ1dGVzKGVsZW1lbnQpO1xyXG5cdFx0XHRcdFx0dmFyIHByb21pc2UgPSBwZGZQcmludGVyLmdlbmVyYXRlUGRmRnJvbUVsZW1lbnQoZWxlbWVudCwgY29uZmlnLm9yaWVudGF0aW9uLCBjb25maWcudW5pdCwgY29uZmlnLmZvcm1hdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgcHJvbWlzZS50aGVuKGZ1bmN0aW9uIChwZGYpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoJHNjb3BlLnNhdmVBcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGRmLnNhdmUoJHNjb3BlLnNhdmVBcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwZGYub3V0cHV0KCdkYXRhdXJsbmV3d2luZG93Jyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBkZiA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdHRocm93IG5ldyBTeW50YXhFcnJvcignTm8gdGVtcGxhdGUgZWxlbWVudCBwcm92aWRlZC4gVHJ5IHVzaW5nIG5nUHJpbnRhYmxlIGRpcmVjdGl2ZS4nKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH07XHJcblxyXG5cdFx0XHRlbGVtZW50Lm9uKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5wcmludCgpO1xyXG4gICAgICAgICAgICB9KTtcclxuXHRcdH1cclxuXHR9O1xyXG59XSk7IiwiLypnbG9iYWwgbmdQcmludCovXHJcblxyXG5uZ1ByaW50LmRpcmVjdGl2ZSgnbmdQcmludGFibGUnLCBbZnVuY3Rpb24gKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG4gICAgXHJcblx0cmV0dXJuIHtcclxuXHRcdHJlc3RyaWN0OiAnQScsXHJcbiAgICAgICAgc2NvcGU6IHtcclxuICAgICAgICAgICAgb3JpZW50YXRpb246ICdAPycsXHJcbiAgICAgICAgICAgIHVuaXQ6ICdAPycsXHJcbiAgICAgICAgICAgIGZvcm1hdDogJ0A/J1xyXG4gICAgICAgIH0sXHJcblx0XHRsaW5rOiBmdW5jdGlvbiAoJHNjb3BlLCBlbGVtZW50KSB7XHJcblx0XHRcdCRzY29wZS5lbGVtZW50ID0gZWxlbWVudDtcclxuXHRcdH0sXHJcbiAgICAgICAgY29udHJvbGxlcjogZnVuY3Rpb24gKCRzY29wZSkge1xyXG4gICAgICAgICAgICB0aGlzLmdldEVsZW1lbnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJHNjb3BlLmVsZW1lbnQ7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxufV0pO1xyXG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=